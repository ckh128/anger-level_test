<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>í™§ë³‘ì§€ìˆ˜ í…ŒìŠ¤íŠ¸</title>

<style>
  body {
    font-family: "Pretendard", "Apple SD Gothic Neo", sans-serif;
    background: linear-gradient(135deg, #fff0f0, #ffeaea);
    color: #333;
    margin: 0;
    padding: 20px;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }
  h1 {
    text-align: center;
    color: #d24;
    font-size: 1.8rem;
  }
  .question {
    margin: 20px 0;
    padding: 15px;
    background: #fff;
    border-radius: 15px;
    box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    font-size: 0.95rem;
  }
  label { 
    margin-right: 10px;
    display: inline-block;
    margin-top: 5px;
  }
  #submitBtn {
    display: block;
    margin: 30px auto;
    background: #ff5252;
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: 10px;
    font-size: 1rem;
    cursor: pointer;
    transition: 0.3s;
  }
  #submitBtn:hover {
    background: #e04141;
    transform: scale(1.03);
  }
  #result {
    text-align: center;
    margin-top: 30px;
    font-size: 1rem;
  }
  .gauge {
    width: 90%;
    height: 20px;
    background: #ddd;
    border-radius: 15px;
    margin: 15px auto;
    overflow: hidden;
  }
  .bar {
    height: 100%;
    width: 0;
    border-radius: 15px;
    transition: width 1s ease, background 0.5s ease;
  }
  .share-btn {
    background: #1da1f2;
    color: white;
    border: none;
    padding: 10px 18px;
    border-radius: 8px;
    margin: 5px;
    cursor: pointer;
    font-size: 0.9rem;
  }
  .share-btn.kakao { background: #fae100; color: #3c1e1e; }
  .share-btn.copy { background: #444; }
  .share-btn.save { background: #ff7043; }
  .card {
    width: 90%;
    max-width: 340px;
    margin: 25px auto;
    background: white;
    border-radius: 20px;
    padding: 20px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  }
  .emoji { font-size: 2.8rem; }
  @media (max-width: 500px) {
    body { padding: 10px; }
    h1 { font-size: 1.5rem; }
    .question { font-size: 0.9rem; }
    #submitBtn { font-size: 0.9rem; padding: 10px 20px; }
    .share-btn { font-size: 0.8rem; padding: 8px 15px; }
  }
</style>
</head>

<body>

<h1>ğŸ’¥ í™§ë³‘ì§€ìˆ˜ í…ŒìŠ¤íŠ¸</h1>
<p style="text-align:center;">ê° ìƒí™©ì—ì„œ <b>ê²‰ìœ¼ë¡œ ë“œëŸ¬ë‚´ëŠ” ë°˜ì‘ì˜ ê°•ë„</b>ë¥¼ ì„ íƒí•˜ì„¸ìš”<br>(1 = ê°•í•˜ê²Œ í‘œí˜„, 5 = ê±°ì˜ í‘œí˜„ ì•ˆ í•¨)</p>

<div id="quiz"></div>

<button id="submitBtn" onclick="calculate()">ê²°ê³¼ ë³´ê¸°</button>
<div id="result"></div>

<!-- html2canvas -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<!-- Kakao SDK -->
<script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
<script>
  Kakao.init("e769fc93830b8cb68c6d46ab2864f317");
</script>

<script>
// -----------------------------
// ì§ˆë¬¸ë“¤ (ë„ˆê°€ ìˆ˜ì •í•œ ë²„ì „ ê·¸ëŒ€ë¡œ ì¨ë„ ë¨)
// -----------------------------
const questions = [
  "ì¹œêµ¬ê°€ ì•½ì†ì— 30ë¶„ ëŠ¦ì—ˆëŠ”ë° 'ë¯¸ì•ˆ! ì°¨ê°€ ë§‰í˜€ì„œ'ë¼ê³  í•œë‹¤.",
  "ì¹´í˜ì—ì„œ ì£¼ë¬¸í•œ ìŒë£Œê°€ ì˜ëª» ë‚˜ì™”ë‹¤.",
  "ì¡°ë³„ê³¼ì œì—ì„œ ì¡°ì›ì´ ì¤€ë¹„í•œ ê²Œ ì—†ë‹¤.",
  "ì¹œêµ¬ê°€ ë‚´ ì˜· ìŠ¤íƒ€ì¼ì„ ì§€ì í•œë‹¤.",
  "ë³„ë¡œ ì•ˆ ì¹œí•œ ì‚¬ëŒì´ ì£¼ë§ì— ì´ì‚¬ë¥¼ ë„ì™€ë‹¬ë¼ê³  í•œë‹¤.",
  "ë‹¨í†¡ë°©ì—ì„œ ë¶ˆí¸í•œ ë§ì„ ê³„ì†í•˜ëŠ” ì‚¬ëŒì´ ìˆë‹¤.",
  "ì—°ì¸ì´ ì¤‘ìš”í•œ ì•½ì†ì„ ìŠì–´ë²„ë ¸ë‹¤.",
  "ë‚˜ì— ëŒ€í•œ ì˜¤í•´ë‚˜ ë’·ë§ì„ ì „í•´ ë“¤ì—ˆë‹¤.",
  "íšŒì˜/ê³¼ì œì—ì„œ ë‚´ ì˜ê²¬ì´ ë°˜ë³µí•´ì„œ ë¬´ì‹œëœë‹¤.",
  "ê°€ì¡±/ì¹œêµ¬ê°€ ë‚˜ë¥¼ ìœ„í•œë‹¤ë©° ì”ì†Œë¦¬ë¥¼ ê³„ì†í•œë‹¤."
];

// ì§ˆë¬¸ HTML ìƒì„±
const quizDiv = document.getElementById("quiz");

questions.forEach((q, i) => {
  let html = `<div class="question"><p><b>${i + 1}. ${q}</b></p>`;
  for (let j = 1; j <= 5; j++) {
    const labels = ["ê°•í•˜ê²Œ í‘œí˜„", "ì¡°ê¸ˆ ê°•í•˜ê²Œ í‘œí˜„", "ë³´í†µ", "ì¡°ê¸ˆ ì°¸ìŒ", "ê±°ì˜ í‘œí˜„ ì•ˆí•¨"];
    html += `<label><input type="radio" name="q${i}" value="${j}"> ${j} (${labels[j-1]})</label>`;
  }
  html += "</div>";
  quizDiv.innerHTML += html;
});

// -----------------------------
// ê²°ê³¼ ê³„ì‚° (í™§ë³‘ì§€ìˆ˜ ë²„ì „)
// -----------------------------
function calculate() {
  let total = 0;

  for (let i = 0; i < questions.length; i++) {
    const val = document.querySelector(`input[name=q${i}]:checked`);
    if (val) total += parseInt(val.value);
    else {
      alert(`${i + 1}ë²ˆ ë¬¸í•­ì— ë‹µí•´ì£¼ì„¸ìš”!`);
      return;
    }
  }

  // ì„¤ë¬¸ ìˆ¨ê¸°ê¸°
  document.getElementById("quiz").style.display = "none";
  document.getElementById("submitBtn").style.display = "none";

  // ì ìˆ˜(ìµœëŒ€ 100)
  const level = Math.max(10, Math.min(100, Math.round(total * 2)));
  const hue = Math.round(200 - (level * 1.5));
  const barColor = `hsl(${hue}, 85%, 55%)`;

  let msg = "", emoji = "";

  // ì ìˆ˜ ë†’ìŒ = í™”ë¥¼ ëª» ë‚´ê³  ë§ì´ ì°¸ëŠ” íƒ€ì… (í™§ë³‘ì§€ìˆ˜ ë†’ìŒ)
  if (level < 40) {
    msg = "ê°ì •ì„ ê±´ê°•í•˜ê²Œ í‘œí˜„í•˜ëŠ” í¸ì´ì—ìš”.";
    emoji = "ğŸŒ¤ï¸";
  } else if (level < 70) {
    msg = "ì ë‹¹íˆ í‘œí˜„í•˜ê³  ì ë‹¹íˆ ì°¸ëŠ” ì„±í–¥ì´ì—ìš”.";
    emoji = "â›…";
  } else if (level < 90) {
    msg = "í™”ë¥¼ ì˜ ëª» ë‚´ê³  ì†ì— ìŒ“ì•„ë‘ëŠ” í¸ì´ì—ìš”.";
    emoji = "ğŸ”¥";
  } else {
    msg = "ê°ì •ì„ ê±°ì˜ í‘œí˜„í•˜ì§€ ì•Šì•„ í™§ë³‘ì´ ì‹¬í•˜ê²Œ ëˆ„ì ë˜ëŠ” íƒ€ì…ì´ì—ìš”.";
    emoji = "ğŸŒ‹";
  }

  const shareText = `ğŸ’¥ ë‚˜ì˜ 'í™§ë³‘ì§€ìˆ˜'ëŠ” ${level}! (${msg}) ğŸ‘‰ ë„ˆë„ í…ŒìŠ¤íŠ¸ í•´ë´: https://ckh128.github.io/anger-level_test/`;

  document.getElementById("result").innerHTML = `
    <div class="card" id="resultCard">
      <div class="emoji">${emoji}</div>
      <h2>ë‹¹ì‹ ì˜ í™§ë³‘ì§€ìˆ˜: ${level}</h2>
      <div class="gauge"><div class="bar" style="width:${level}%; background:${barColor};"></div></div>
      <p><b>${msg}</b></p>

      <button class="share-btn" onclick="shareTwitter('${shareText}')">íŠ¸ìœ„í„° ê³µìœ </button>
      <button class="share-btn kakao" onclick="shareKakao('${shareText}')">ì¹´ì¹´ì˜¤í†¡ ê³µìœ </button>
      <button class="share-btn copy" onclick="copyLink('${shareText}')">ë§í¬ ë³µì‚¬</button>
      <button class="share-btn save" onclick="saveImage()">ì´ë¯¸ì§€ ì €ì¥í•˜ê¸° ğŸ“¸</button>
    </div>
  `;
}

// -----------------------------
// ê³µìœ  ê¸°ëŠ¥
// -----------------------------
function shareTwitter(text) {
  const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`;
  window.open(url, "_blank");
}

function shareKakao(text) {
  if (!Kakao.isInitialized()) {
    alert("ì¹´ì¹´ì˜¤ SDK ë¯¸ì´ˆê¸°í™”!");
    return;
  }
  Kakao.Link.sendDefault({
    objectType: 'feed',
    content: {
      title: 'ğŸ’¥ ë‚˜ì˜ í™§ë³‘ì§€ìˆ˜ í…ŒìŠ¤íŠ¸ ê²°ê³¼',
      description: text,
      imageUrl: 'https://ckh128.github.io/anger-level_test/preview.png',
      link: {
        mobileWebUrl: 'https://ckh128.github.io/anger-level_test/',
        webUrl: 'https://ckh128.github.io/anger-level_test/'
      }
    },
    buttons: [
      {
        title: 'í…ŒìŠ¤íŠ¸ í•´ë³´ê¸°',
        link: {
          mobileWebUrl: 'https://ckh128.github.io/anger-level_test/',
          webUrl: 'https://ckh128.github.io/anger-level_test/'
        }
      }
    ]
  });
}

async function copyLink(text) {
  try {
    await navigator.clipboard.writeText(text);
    alert("ğŸ”— ê²°ê³¼ ë§í¬ ë³µì‚¬ ì™„ë£Œ!");
  } catch (err) {
    const temp = document.createElement("textarea");
    temp.value = text;
    document.body.appendChild(temp);
    temp.select();
    document.execCommand("copy");
    document.body.removeChild(temp);
    alert("ğŸ”— ë³µì‚¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!");
  }
}

function saveImage() {
  const card = document.getElementById("resultCard");
  html2canvas(card, { scale: 2 }).then(canvas => {
    const link = document.createElement("a");
    link.download = "í™§ë³‘ì§€ìˆ˜_ê²°ê³¼.png";
    link.href = canvas.toDataURL("image/png");
    link.click();
  });
}
</script>

</body>
</html>
