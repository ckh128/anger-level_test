<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë‚˜ëŠ” í™”ë¥¼ ì˜ ë‚´ëŠ” ì‚¬ëŒì¸ê°€?</title>
<style>
  body {
    font-family: "Pretendard", "Apple SD Gothic Neo", sans-serif;
    background: linear-gradient(135deg, #fff0f0, #ffeaea);
    color: #333;
    margin: 0;
    padding: 20px;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }
  h1 {
    text-align: center;
    color: #d24;
    font-size: 1.8rem;
  }
  .question {
    margin: 20px 0;
    padding: 15px;
    background: #fff;
    border-radius: 15px;
    box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    font-size: 0.95rem;
  }
  label { 
    margin-right: 10px;
    display: inline-block;
    margin-top: 5px;
  }
  #submitBtn {
    display: block;
    margin: 30px auto;
    background: #ff5252;
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: 10px;
    font-size: 1rem;
    cursor: pointer;
    transition: 0.3s;
  }
  #submitBtn:hover {
    background: #e04141;
    transform: scale(1.03);
  }
  #result {
    text-align: center;
    margin-top: 30px;
    font-size: 1rem;
  }
  .gauge {
    width: 90%;
    height: 20px;
    background: #ddd;
    border-radius: 15px;
    margin: 15px auto;
    overflow: hidden;
  }
  .bar {
    height: 100%;
    width: 0;
    border-radius: 15px;
    transition: width 1s ease, background 0.5s ease;
  }
  .share-btn {
    background: #1da1f2;
    color: white;
    border: none;
    padding: 10px 18px;
    border-radius: 8px;
    margin: 5px;
    cursor: pointer;
    font-size: 0.9rem;
  }
  .share-btn.kakao { background: #fae100; color: #3c1e1e; }
  .share-btn.copy { background: #444; }
  .share-btn.save { background: #ff7043; }
  .card {
    width: 90%;
    max-width: 340px;
    margin: 25px auto;
    background: white;
    border-radius: 20px;
    padding: 20px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  }
  .emoji { font-size: 2.8rem; }
  @media (max-width: 500px) {
    body { padding: 10px; }
    h1 { font-size: 1.5rem; }
    .question { font-size: 0.9rem; }
    #submitBtn { font-size: 0.9rem; padding: 10px 20px; }
    .share-btn { font-size: 0.8rem; padding: 8px 15px; }
  }
</style>
</head>
<body>

<h1>ğŸ”¥ ë‚˜ëŠ” í™”ë¥¼ ì˜ ë‚´ëŠ” ì‚¬ëŒì¸ê°€?</h1>
<p style="text-align:center;">ê° ë¬¸í•­ì— ëŒ€í•´ ìì‹ ì˜ ë°˜ì‘ ê°•ë„ë¥¼ ì„ íƒí•˜ì„¸ìš”<br>(1=ì•„ì£¼ ì•½í•¨, 5=ì•„ì£¼ ê°•í•¨)</p>

<div id="quiz"></div>

<button id="submitBtn" onclick="calculate()">ê²°ê³¼ ë³´ê¸°</button>

<div id="result"></div>

<!-- html2canvas for image capture -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<!-- âœ… Kakao SDK -->
<script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
<script>
  Kakao.init("e769fc93830b8cb68c6d46ab2864f317");
  console.log("âœ… Kakao SDK ì´ˆê¸°í™” ì™„ë£Œ:", Kakao.isInitialized());
</script>

<script>
const questions = [
  "ì¹œêµ¬ê°€ ì•½ì†ì— 30ë¶„ ëŠ¦ì—ˆë‹¤. 'ë¯¸ì•ˆ! ì°¨ê°€ ë§‰í˜€ì„œ'ë¼ê³  í•  ë•Œ ë‚˜ëŠ”?",
  "ì¹´í˜ì—ì„œ ì£¼ë¬¸í•œ ìŒë£Œê°€ ì˜ëª» ë‚˜ì™”ë‹¤.",
  "ì¡°ë³„ ê³¼ì œì—ì„œ ì¡°ì›ì´ ìë£Œ ì¡°ì‚¬ë¥¼ ì•„ì˜ˆ ì•ˆ í•´ì™”ë‹¤.",
  "ì¹œêµ¬ê°€ ë‚´ ì˜· ìŠ¤íƒ€ì¼ì„ ì§€ì í•œë‹¤. 'ë„ˆ ê·¸ê±° ì¢€ ì•ˆ ì–´ìš¸ë ¤.'",
  "ë³„ë¡œ ì•ˆ ì¹œí•œ ì§€ì¸ì´ ì£¼ë§ì— ì´ì‚¬ ì¢€ ë„ì™€ë‹¬ë¼ê³  ë¶€íƒí•œë‹¤.",
  "ë‹¨í†¡ë°©ì—ì„œ ëˆ„êµ°ê°€ ë‚´ ê°€ì¹˜ê´€ê³¼ ì•ˆ ë§ëŠ” ì–˜ê¸°ë¥¼ ê³„ì†í•œë‹¤.",
  "ì—°ì¸ì´ ë‚˜ì™€ì˜ ì•½ì†ì„ ìŠì–´ë²„ë ¸ë‹¤.",
  "ë‚˜ì— ëŒ€í•œ ì˜¤í•´(ë’·ë‹´í™”)ë¥¼ ìš°ì—°íˆ ë“¤ì—ˆë‹¤.",
  "ë‚´ê°€ 'í™”ê°€ ë‚¬ë‹¤'ëŠ” ê±¸ ê¹¨ë‹¬ì•˜ì„ ë•Œ, ê°€ì¥ ë¨¼ì € ë“œëŠ” ìƒê°ì€?",
  "ê°ˆë“±ì´ (ì–´ë–»ê²Œë“ ) ëë‚œ í›„, ë‚˜ëŠ”?"
];

const quizDiv = document.getElementById("quiz");

questions.forEach((q, i) => {
  let html = `<div class="question"><p><b>${i + 1}. ${q}</b></p>`;
  for (let j = 1; j <= 5; j++) {
    const labels = ["ì•„ì£¼ ì•½í•¨", "ì•½í•¨", "ë³´í†µ", "ê°•í•¨", "ì•„ì£¼ ê°•í•¨"];
    html += `<label><input type="radio" name="q${i}" value="${j}"> ${j} (${labels[j-1]})</label>`;
  }
  html += "</div>";
  quizDiv.innerHTML += html;
});

function calculate() {
  let total = 0;
  for (let i = 0; i < questions.length; i++) {
    const val = document.querySelector(`input[name=q${i}]:checked`);
    if (val) total += parseInt(val.value);
    else {
      alert(`${i + 1}ë²ˆ ë¬¸í•­ì— ë‹µí•´ì£¼ì„¸ìš”!`);
      return;
    }
  }

  // ğŸ”¥ ì„¤ë¬¸ ìˆ¨ê¸°ê¸°
  document.getElementById("quiz").style.display = "none";
  document.getElementById("submitBtn").style.display = "none";

  const level = Math.max(10, Math.min(100, Math.round(total * 2)));
  const hue = Math.round(200 - (level * 1.5));
  const barColor = `hsl(${hue}, 85%, 55%)`;

  let msg = "", emoji = "";
  if (level < 40) { msg = "ê°ì •ì„ ì†ìœ¼ë¡œ ì‚¼í‚¤ëŠ” íƒ€ì…"; emoji = "ğŸ§Š"; }
  else if (level < 70) { msg = "ìƒí™©ì— ë”°ë¼ ì ì ˆíˆ í‘œí˜„í•˜ëŠ” íƒ€ì…"; emoji = "ğŸŒ¤"; }
  else if (level < 90) { msg = "ê°ì •ì„ ì†”ì§í•˜ê²Œ ë“œëŸ¬ë‚´ëŠ” íƒ€ì…"; emoji = "ğŸ”¥"; }
  else { msg = "ì°¸ì§€ ì•Šê³  ì¦‰ê°ì ìœ¼ë¡œ ë°˜ì‘í•˜ëŠ” íƒ€ì…"; emoji = "ğŸŒ‹"; }

  const shareText = `ğŸ”¥ ë‚˜ì˜ í™”ë‚´ê¸° ë ˆë²¨ì€ ${level}! (${msg}) ğŸ‘‰ ë„ˆë„ í…ŒìŠ¤íŠ¸ í•´ë´: https://ckh128.github.io/anger-level_test/`;

  document.getElementById("result").innerHTML = `
    <div class="card" id="resultCard">
      <div class="emoji">${emoji}</div>
      <h2>ë‹¹ì‹ ì˜ í™”ë‚´ê¸° ë ˆë²¨: ${level}</h2>
      <div class="gauge"><div class="bar" style="width:${level}%; background:${barColor};"></div></div>
      <p><b>${msg}</b></p>
      <button class="share-btn" onclick="shareTwitter('${shareText}')">íŠ¸ìœ„í„° ê³µìœ </button>
      <button class="share-btn kakao" onclick="shareKakao('${shareText}')">ì¹´ì¹´ì˜¤í†¡ ê³µìœ </button>
      <button class="share-btn copy" onclick="copyLink('${shareText}')">ë§í¬ ë³µì‚¬</button>
      <button class="share-btn save" onclick="saveImage()">ì´ë¯¸ì§€ ì €ì¥í•˜ê¸° ğŸ“¸</button>
    </div>
  `;
}

function shareTwitter(text) {
  const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`;
  window.open(url, "_blank");
}

function shareKakao(text) {
  if (!Kakao.isInitialized()) {
    alert("ì¹´ì¹´ì˜¤ SDKê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í‚¤ë¥¼ í™•ì¸í•˜ì„¸ìš”!");
    return;
  }
  Kakao.Link.sendDefault({
    objectType: 'feed',
    content: {
      title: 'ğŸ”¥ ë‚˜ì˜ í™”ë‚´ê¸° ë ˆë²¨ í…ŒìŠ¤íŠ¸ ê²°ê³¼',
      description: text,
      imageUrl: 'https://ckh128.github.io/anger-level_test/preview.png',
      link: {
        mobileWebUrl: 'https://ckh128.github.io/anger-level_test/',
        webUrl: 'https://ckh128.github.io/anger-level_test/'
      }
    },
    buttons: [
      {
        title: 'ë‚˜ë„ í…ŒìŠ¤íŠ¸í•˜ê¸°',
        link: {
          mobileWebUrl: 'https://ckh128.github.io/anger-level_test/',
          webUrl: 'https://ckh128.github.io/anger-level_test/'
        }
      }
    ]
  });
}

async function copyLink(text) {
  try {
    await navigator.clipboard.writeText(text);
    alert("âœ… ê²°ê³¼ ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\nì›í•˜ëŠ” SNSë‚˜ ë©”ì‹ ì €ì— ë¶™ì—¬ë„£ì–´ë³´ì„¸ìš”.");
  } catch (err) {
    const temp = document.createElement("textarea");
    temp.value = text;
    document.body.appendChild(temp);
    temp.select();
    document.execCommand("copy");
    document.body.removeChild(temp);
    alert("âœ… ë³µì‚¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!");
  }
}

function saveImage() {
  const card = document.getElementById("resultCard");
  html2canvas(card, { scale: 2 }).then(canvas => {
    const link = document.createElement("a");
    link.download = "í™”í…ŒìŠ¤íŠ¸ê²°ê³¼.png";
    link.href = canvas.toDataURL("image/png");
    link.click();
  });
}
</script>
</body>
</html>
